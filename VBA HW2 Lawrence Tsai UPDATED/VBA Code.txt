Sub test()For Each ws In Worksheets'Code for Easy and Moderate OptionDim Ticker As StringDim Ticker_Total As DoubleDim Year_Open As DoubleDim Year_Close As Doublews.Range("I1").Value = "Ticker"ws.Range("J1").Value = "Yearly Change"ws.Range("K1").Value = "Percent Change"ws.Range("L1").Value = "Total Stock Volume"ws.Range("P1").Value = "Ticker"ws.Range("Q1").Value = "Value"ws.Range("O2").Value = "Greatest % Increase"ws.Range("O3").Value = "Greatest % Decrease"ws.Range("O4").Value = "Greatest Total Volume"Total_Stock_Volume = 0Dim Summary_Table_Row As IntegerSummary_Table_Row = 2LastRow = ws.Cells(Rows.Count, 7).End(xlUp).RowFor i = 2 To LastRow'Sub code for determining Open Price per TickerIf ws.Cells(i, 2).Value < ws.Cells(i - 1, 2).Value ThenYear_Open = ws.Cells(i, 3).ValueEnd IfIf ws.Cells(i + 1, 1).Value <> ws.Cells(i, 1).Value ThenTicker_Name = ws.Cells(i, 1).ValueTotal_Stock_Volume = Total_Stock_Volume + ws.Cells(i, 7).ValueYear_Close = ws.Cells(i, 6).Valuews.Range("I" & Summary_Table_Row).Value = Ticker_Namews.Range("L" & Summary_Table_Row).Value = Total_Stock_Volumews.Range("J" & Summary_Table_Row).Value = Year_Close - Year_Open'On Error Resume Next is to address the division by 0 error caused by ticker PLNT in year 2015On Error Resume Nextws.Range("K" & Summary_Table_Row).Value = (Year_Close - Year_Open) / Year_OpenSummary_Table_Row = Summary_Table_Row + 1Total_Stock_Volume = 0ElseTotal_Stock_Volume = Total_Stock_Volume + ws.Cells(i, 7).ValueEnd IfNext i  'Loop for Coloring Column JDim c As IntegerLastRowColor = ws.Cells(Rows.Count, 10).End(xlUp).RowFor c = 2 To LastRowColorIf ws.Cells(c, 10).Value > 0 Thenws.Cells(c, 10).Interior.ColorIndex = 4Elsews.Cells(c, 10).Interior.ColorIndex = 3End IfNext c'Code for Hard OptionDim j As IntegerDim GreatestIncreaseAnswer As DoubleDim GreatestIncreaseTicker As StringDim GreatestDecreaseAnswer As DoubleDim GreatestDecreaseTicker As StringDim GreatestVolumeAnswer As DoubleDim GreatestVolumeTicker As StringGreatestIncreaseValue = 0GreatestDecreaseValue = 0GreatestVolumeValue = 0LastRowHard = ws.Cells(Rows.Count, 9).End(xlUp).Row  For j = 2 To LastRowHard  If ws.Cells(j, 11).Value > GreatestIncreaseValue ThenGreatestIncreaseValue = ws.Cells(j, 11).ValueGreatestIncreaseAnswer = ws.Cells(j, 11).ValueGreatestIncreaseTicker = ws.Cells(j, 9).ValueEnd IfIf ws.Cells(j, 11).Value < GreatestDecreaseValue ThenGreatestDecreaseValue = ws.Cells(j, 11).ValueGreatestDecreaseAnswer = ws.Cells(j, 11).ValueGreatestDecreaseTicker = ws.Cells(j, 9).ValueEnd IfIf ws.Cells(j, 12).Value > GreatestVolumeValue ThenGreatestVolumeValue = ws.Cells(j, 12).ValueGreatestVolumeAnswer = ws.Cells(j, 12).ValueGreatestVolumeTicker = ws.Cells(j, 9).ValueEnd If  Next j  ws.Range("P2") = GreatestIncreaseTickerws.Range("P3") = GreatestDecreaseTickerws.Range("P4") = GreatestVolumeTickerws.Range("Q2") = GreatestIncreaseAnswerws.Range("Q3") = GreatestDecreaseAnswerws.Range("Q4") = GreatestVolumeAnswerws.Range("Q2").NumberFormat = "0.00%"ws.Range("Q3").NumberFormat = "0.00%"ws.Range("K:K").NumberFormat = "0.00%"ws.Columns("J:Q").AutoFitNext wsEnd Sub